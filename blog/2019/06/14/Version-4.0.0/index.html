<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Version 4.0.0 · Podium</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="We are very happy to release version 4.0.0 of Podium. Both `@podium/layout` and"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Version 4.0.0 · Podium"/><meta property="og:type" content="website"/><meta property="og:url" content="https://podium-lib.io//blog/2019/06/14/Version-4.0.0"/><meta property="og:description" content="We are very happy to release version 4.0.0 of Podium. Both `@podium/layout` and"/><meta property="og:image" content="https://podium-lib.io/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://podium-lib.io/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/img/favicon-32x32.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css"/><link rel="alternate" type="application/atom+xml" href="https://podium-lib.io/blog/atom.xml" title="Podium Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://podium-lib.io/blog/feed.xml" title="Podium Blog RSS Feed"/><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/favicon-96x96.png" alt="Podium"/><h2 class="headerTitleWithLogo">Podium</h2></a><a href="/versions"><h3>4.0.0</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/docs/podium/conceptual_overview" target="_self">Overview</a></li><li class=""><a href="/docs/podlet/getting_started" target="_self">Podlets</a></li><li class=""><a href="/docs/layout/getting_started" target="_self">Layouts</a></li><li class=""><a href="/docs/api/getting_started" target="_self">API</a></li><li class=""><a href="/help" target="_self">Help</a></li><li class="siteNavGroupActive"><a href="/blog/" target="_self">Blog</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Recent Posts</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Recent Posts</h3><ul class=""><li class="navListItem navListItemActive"><a class="navItem" href="/blog/2019/06/14/Version-4.0.0">Version 4.0.0</a></li><li class="navListItem"><a class="navItem" href="/blog/2019/05/20/new-documentation">New documentation site</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer postContainer blogContainer"><div class="wrapper"><div class="lonePost"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle"><a href="/blog/2019/06/14/Version-4.0.0">Version 4.0.0</a></h1><p class="post-meta">June 14, 2019</p><div class="authorBlock"><p class="post-authorName"><a href="https://github.com/trygve-lie/" target="_blank" rel="noreferrer noopener">Trygve Lie</a></p></div></header><div><span><p>We are very happy to release version 4.0.0 of Podium. Both <code>@podium/layout</code> and
<code>@podium/podlet</code> are now available at v4.0.0.</p>
<p>Version 4.0.0 attempts to be almost entirely backwards compatible with version 3.0.0.</p>
<p>This release contains the following changes:</p>
<h3><a class="anchor" aria-hidden="true" id="json-schema"></a><a href="#json-schema" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>JSON Schema</h3>
<p>The manifest which defines the contract between layouts and podlets are now
defined using <a href="https://github.com/podium-lib/schemas/blob/master/lib/manifest.schema.json">JSON Schema</a>. The main reason for this is to cater for Podium implementations
in languages other than Node.js.</p>
<h3><a class="anchor" aria-hidden="true" id="document-template"></a><a href="#document-template" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Document template</h3>
<p>This version introduces a concept we call a document template.
A document template is intended to supply the necessary HTML for the page outside of the markup you need write to display your page content.</p>
<p>While a v4 ships with a default document template it's straight forward to build your own custom template and plug this into both layouts and podlets
which helps make it easier to develop podlets in isolation (from layouts) while imposing the same constraints on it that it will have when included in a layout.</p>
<p>Please see the <a href="/docs/next/api/document">document template</a> section for further
information.</p>
<h3><a class="anchor" aria-hidden="true" id="http-framework-free"></a><a href="#http-framework-free" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>HTTP framework free</h3>
<p>Originally Podium was bound to Express.js but with this release Podium is 100%
HTTP framework free. It is even possible write Podium servers using only the core Node.js HTTP
server module.</p>
<p>Having said this, Express.js is still first class in Podium which means it is still possible to use Podium in
an Express.js server without anything more than the core Podium layout and podlet modules.</p>
<p>Besides supporting Express.js, Hapi and Fastify are supported through plugins maintained by
the Podium team.</p>
<p>Serverless / cloud functions will also be supported in a future release.</p>
<h3><a class="anchor" aria-hidden="true" id="multiple-assets-support"></a><a href="#multiple-assets-support" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Multiple assets support</h3>
<p>It was previously only possible to set a single reference to JavaScript and CSS client side assets using a podlet's
<code>.js()</code> and <code>.css()</code>.</p>
<p>With version 4, it is now possible to call these methods multiple times to set multiple assets.</p>
<p>An additional <code>type</code> field has also been added to the <code>.js()</code> method making it possible to signal to layout servers
what type of JavaScript file are being specified.</p>
<h3><a class="anchor" aria-hidden="true" id="layout-assets"></a><a href="#layout-assets" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Layout assets</h3>
<p>The <code>@podium/layout</code> module now has <code>.js()</code> and <code>.css()</code> methods which work the
same way as in <code>@podium/podlet</code>. The intent is to be able to set client side assets
which are related specifically to the layout.</p>
<h3><a class="anchor" aria-hidden="true" id="httpincoming-replaces-context-argument"></a><a href="#httpincoming-replaces-context-argument" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>HttpIncoming replaces context argument</h3>
<p>During the process of rewriting to HTTP framework free, an <code>HttpIncoming</code> object was introduced which
is passed between the various parts of Podium.</p>
<p>You can read more about <a href="/docs/next/api/incoming"><code>HttpIncoming</code> and its role here</a>.</p>
<p>Due to this, you should pass an instance of <code>HttpIncoming</code> (available at <code>res.locals.podium</code> in express) to the <code>.client.fetch()</code> and <code>.client.stream()</code> methods in
a <code>@podium/layout</code> instead of the context.</p>
<p>Previously Podium expected you to pass a Podium context to the fetch method like so:</p>
<pre><code class="hljs css language-js">app.get(<span class="hljs-string">'/'</span>, (req, res) =&gt; {
    <span class="hljs-keyword">const</span> ctx = res.locals.podium.context;
    <span class="hljs-keyword">const</span> content = <span class="hljs-keyword">await</span> podlet.fetch(ctx);
    ...
});
</code></pre>
<p>This will still work until Podium version 5 but it is expected that developers instead call fetch as follows:</p>
<pre><code class="hljs css language-js">app.get(<span class="hljs-string">'/'</span>, (req, res) =&gt; {
    <span class="hljs-keyword">const</span> incoming = res.locals.podium;
    <span class="hljs-keyword">const</span> content = <span class="hljs-keyword">await</span> podlet.fetch(incoming);
    ...
});
</code></pre>
<p>The context is part of <code>HttpIncoming</code>.</p>
<h3><a class="anchor" aria-hidden="true" id="the-fetch-method-now-resolves-with-a-response-object"></a><a href="#the-fetch-method-now-resolves-with-a-response-object" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The fetch method now resolves with a response object</h3>
<p>When a Layout retrieves the content from a podlet it will now resolve with a
response object instead of just the content as a string.</p>
<p>Previously calling <code>.client.fetch()</code> would resolve with the content of a podlet as
a string:</p>
<pre><code class="hljs css language-js">app.get(<span class="hljs-string">'/'</span>, (req, res) =&gt; {
    <span class="hljs-keyword">const</span> incoming = res.locals.podium;
    <span class="hljs-keyword">const</span> content = <span class="hljs-keyword">await</span> podlet.fetch(incoming);
    <span class="hljs-built_in">console</span>.log(content);  <span class="hljs-comment">// &lt;div&gt; .... &lt;/div&gt;</span>
});
</code></pre>
<p>Now the fetch method with resolve with and object containing the podlet's content, css, js and
headers:</p>
<pre><code class="hljs css language-js">app.get(<span class="hljs-string">'/'</span>, (req, res) =&gt; {
    <span class="hljs-keyword">const</span> incoming = res.locals.podium;
    <span class="hljs-keyword">const</span> content = <span class="hljs-keyword">await</span> podlet.fetch(incoming);
    <span class="hljs-built_in">console</span>.log(content);  <span class="hljs-comment">// {js: [], css: [], headers: {}, content: '&lt;div&gt; .... &lt;/div&gt;'}</span>
});
</code></pre>
<p>For backwards compabillity, using the response in a template literal or in string
concatenation will result in the content value in the string. This will still work until
Podium version 5.</p>
<pre><code class="hljs css language-js">app.get(<span class="hljs-string">'/'</span>, (req, res) =&gt; {
    <span class="hljs-keyword">const</span> incoming = res.locals.podium;
    <span class="hljs-keyword">const</span> content = <span class="hljs-keyword">await</span> podlet.fetch(incoming);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${content}</span>`</span>);  <span class="hljs-comment">// &lt;div&gt; .... &lt;/div&gt;</span>
});
</code></pre>
<p>The <code>.client.stream()</code> works as before, but there is now a <code>beforeStream</code> event
which emits a response object:</p>
<pre><code class="hljs css language-js">app.get(<span class="hljs-string">'/'</span>, (req, res, next) =&gt; {
    <span class="hljs-keyword">const</span> incoming = res.locals.podium;

    <span class="hljs-keyword">const</span> stream = component.stream(incoming);
    stream.once(<span class="hljs-string">'beforeStream'</span>, data =&gt; {
        <span class="hljs-built_in">console</span>.log(data); <span class="hljs-comment">// {js: [], css: [], headers: {}, content: null}</span>
    });

    stream.pipe(res);
});
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="state-events"></a><a href="#state-events" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>State events</h3>
<p>The <code>.client</code> in <code>@podium/layout</code> now has an extended <code>state</code> event and <code>.state</code>
property can be used to determine what state a layout is in.</p>
<pre><code class="hljs css language-js">layout.client.on(<span class="hljs-string">'state'</span>, state =&gt; {
    <span class="hljs-built_in">console</span>.log(state);
});

<span class="hljs-keyword">const</span> podlet = layout.client.register({
    <span class="hljs-attr">uri</span>: <span class="hljs-string">'http://foo.site.com/manifest.json'</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">'foo'</span>,
});

app.get(<span class="hljs-string">'/'</span>, (req, res) =&gt; {
    <span class="hljs-keyword">const</span> incoming = res.locals.podium;
    <span class="hljs-keyword">const</span> content = <span class="hljs-keyword">await</span> podlet.fetch(incoming);
    ...
});
</code></pre>
<p>The state provides information about the &quot;podlet update life cycle&quot;. This is
useful for determining when a podlet is being updated and when an update is
complete or if a podlet is in an unhealty state.</p>
<h3><a class="anchor" aria-hidden="true" id="improved-documentation"></a><a href="#improved-documentation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Improved documentation</h3>
<p>In the process of making Podium HTTP framework free and supporting multiple
HTTP framework our documentation site has received some polish.</p>
<p>This site will now hold all documentation for end users of Podium and eventually it will
have code examples reflecting all HTTP frameworks which are officially supported.</p>
<p>From now on, the documentation found in the README's in each module is to be
considered documentation for developing Podium and not end user documentation.</p>
</span></div></div><div class="blogSocialSection"></div></div><div class="blog-recent"><a class="button" href="/blog">Recent Posts</a></div></div></div><nav class="onPageNav"></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/favicon-96x96.png" alt="Podium" width="66" height="58"/></a><div><h5>Documentation</h5><a href="/docs/podium/conceptual_overview">Conceptual overview</a><a href="/docs/podlet/getting_started">Podlets</a><a href="/docs/layout/getting_started">Layouts</a></div><div><h5>API</h5><a href="/docs/api/getting_started">Getting started</a><a href="/docs/api/podlet">Podlets</a><a href="/docs/api/layout">Layouts</a></div><div><h5>Links</h5><a href="/blog">Blog</a><a href="https://github.com/podium-lib/issues">Issues</a><a href="https://github.com/podium-lib">GitHub</a><a href="https://www.npmjs.com/org/podium">npm</a><a href="https://micro-frontends.org/">Micro Frontends</a></div></section><a href="https://finn.no/" target="_blank" rel="noreferrer noopener" class="copyrightLogo"><img src="/img/finn_no_logo.png" alt="FINN.no" width="129" height="45"/></a><section class="copyright">Copyright © 2019 FINN.no Copyright</section></footer></div></body></html>