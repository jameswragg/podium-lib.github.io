<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>📦 Assets</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link type="text/css" rel="stylesheet" href="/Podium/docs/assets/style.css" />
  <link type="text/css" rel="stylesheet" href="/Podium/docs/assets/pilcrow.css" />
  <link type="text/css" rel="stylesheet" href="/Podium/docs/assets/hljs-github.min.css"/>
  <link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css"/>
  <link rel="shortcut icon" href="/Podium/docs/assets/podium.png" type="image/x-icon">
</head>
<body>
  <header>
    <a class="logo" href="/Podium">
      <img class="podium" src="/Podium/docs/assets/podium.png">
      Podium
    </a>
    <div class="links">
      <a href="https://github.schibsted.io/Podium" target="_blank">GitHub</a>
    </div>
  </header>
  <div class="content">
    <nav class="main-navigation">
      
      <h3>Podium</h3>
      <ul>
        <li><a href="/Podium/docs/podium/conceptual_overview.html">📚 Overview</a></li>
      </ul>
      
      <h3>Podlet Guides</h3>
      <ul>
        <li><a href="/Podium/docs/podlets/getting_started.html">🚀 Getting Started</a></li>
        <li><a href="/Podium/docs/podlets/fallbacks.html">🔌 Fallbacks</a></li>
        <li><a href="/Podium/docs/podlets/context.html">✂️ Context</a></li>
        <li><a href="/Podium/docs/podlets/assets.html">📦 Assets</a></li>
        <li><a href="/Podium/docs/podlets/proxying.html">🐠 Proxying</a></li>
        <li><a href="/Podium/docs/podlets/local_development.html">🔥 Development</a></li>
      </ul>

      <h3>Layout Guides</h3>
      <ul>
        <li><a href="/Podium/docs/layouts/getting_started.html">🚀 Getting Started</a></li>
        <li><a href="/Podium/docs/layouts/context.html">✂️ Context</a></li>
        <li><a href="/Podium/docs/layouts/unavailable_podlets.html">🔌 Unavailable Podlets</a></li>
        <li><a href="/Podium/docs/layouts/sharing_state.html">🐠 Sharing State</a></li>
        <li><a href="/Podium/docs/layouts/assets.html">📦 Assets</a></li>
        <li><a href="/Podium/docs/layouts/local_development.html">🔥 Development</a></li>
      </ul>

      <h3>API Docs</h3>
      <ul>
        <li><a href="https://github.schibsted.io/Podium/podlet/blob/master/README.md">📚 Podlet</a></li>
        <li><a href="https://github.schibsted.io/Podium/layout/blob/master/README.md">📚 Layout</a></li>
        <li><a href="https://github.schibsted.io/Podium/context/blob/master/README.md">📚 Context</a></li>
        <li><a href="https://github.schibsted.io/Podium/proxy/blob/master/README.md">📚 Proxy</a></li>
        <li><a href="https://github.schibsted.io/Podium/client/blob/master/README.md">📚 Client</a></li>
      </ul>
    </nav>
    <main class="markdown-body"><h1 id="📦-assets"><a class="header-link" href="#📦-assets"></a>📦 Assets</h1>
<p>One of the key challenges when using micro-frontends like Podium is how to handle client side assets in each page fragment when everything is stitched together into a page.</p>
<p>In the Podium world, a podlet may need to ship with client side JavaScript and/or CSS and when a layout consumes that podlet, it will also need to consume the podlets JavaScript and/or CSS.</p>
<p>The following are a couple of options for how you might tackle this problem though both share such challenges as:</p>
<ul class="list">
<li>how to isolate styling or behavior</li>
<li>how to handle duplication of shared libraries such as React</li>
<li>how to minimize client asset size and number of requests.</li>
</ul>
<p>We are currently iterating over better general solutions to these problems which we will publish as soon as they are ready.</p>
<h2 id="inline-code-approach"><a class="header-link" href="#inline-code-approach"></a>Inline code approach</h2>
<p>This approach involves each podlet defining its assets as inline code in the podlet&#39;s manifest file so that the layout can then include this code directly in its HTML template.</p>
<p><strong>Step 1.</strong></p>
<p>In your podlet, use the podlet asset helper functions to define inline client code.</p>
<p><em>Example</em></p>
<pre class="hljs"><code>podlet.js(<span class="hljs-string">`&lt;script&gt;console.log('hello world');&lt;/script&gt;`</span>);
podlet.css(<span class="hljs-string">`&lt;style&gt;body { background-color: hot-pink; }&lt;/style&gt;`</span>);</code></pre><p><strong>Step 2.</strong></p>
<p>Then, read the podlet code snippets using the layout client and insert these into your HTML.</p>
<p><em>Example</em></p>
<pre class="hljs"><code>app.get(<span class="hljs-string">'/'</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
    <span class="hljs-keyword">const</span> js = layout.client.js();
    <span class="hljs-keyword">const</span> css = layout.client.css();

    res.send(<span class="hljs-string">`
        &lt;html&gt;
            &lt;head&gt;
                <span class="hljs-subst">${css.join(<span class="hljs-string">'\n'</span>)}</span>
            &lt;/head&gt;
            &lt;body&gt;
                ...
                <span class="hljs-subst">${js.join(<span class="hljs-string">'\n'</span>)}</span>
            &lt;/body&gt;
        &lt;/html&gt;
    `</span>);
});</code></pre><h2 id="upload-to-a-cdn-or-remote-server-approach"><a class="header-link" href="#upload-to-a-cdn-or-remote-server-approach"></a>Upload to a CDN or remote server approach</h2>
<p>This approach involves each podlet uploading its assets to a predefined CDN location so that the layout can then include the CDN URLs in its HTML template.</p>
<p><strong>Step 1.</strong></p>
<p>In your podlet, upload your assets to a CDN by whatever means necessary. You might do this whenever your podlet server starts up to ensure the latest version is available on the CDN.</p>
<p><strong>Step 2.</strong></p>
<p>Next, tell the podlet the location of your assets so that it can populate the manifest file.</p>
<p><em>Example</em></p>
<pre class="hljs"><code>podlet.js(<span class="hljs-string">'http://some-cdn.com/client.js'</span>);
podlet.css(<span class="hljs-string">'http://some-cdn.com/style.css'</span>);</code></pre><p><strong>Step 3.</strong></p>
<p>Finally, in your layout, read an array of URLs from the layout client and insert these into your HTML.</p>
<p><em>Example</em></p>
<pre class="hljs"><code>app.get(<span class="hljs-string">'/'</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
    <span class="hljs-keyword">const</span> js = layout.client.js();
    <span class="hljs-keyword">const</span> css = layout.client.css();

    res.send(<span class="hljs-string">`
        &lt;html&gt;
            &lt;head&gt;
                <span class="hljs-subst">${css
                    .map(href =&gt; <span class="hljs-string">`&lt;link rel="stylesheet" href="<span class="hljs-subst">${href}</span>" /&gt;`</span>)
                    .join(<span class="hljs-string">'\n'</span>)}</span>
            &lt;/head&gt;
            &lt;body&gt;
                ...
                <span class="hljs-subst">${js.map(src =&gt; <span class="hljs-string">`&lt;script src="<span class="hljs-subst">${src}</span>"&gt;&lt;/script&gt;`</span>).join(<span class="hljs-string">'\n'</span>)}</span>
            &lt;/body&gt;
        &lt;/html&gt;
    `</span>);
});</code></pre>    </main>
  </div>
  <script>
    (function () {
      var pathname = window.location.pathname.substr(1);
      var activeLink = document.querySelector('a[href="' + pathname + '"]');

      activeLink.classList.add('selected');
    })();
  </script>
</body>
</html>
