<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Podium - 🔌 Fallbacks</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link type="text/css" rel="stylesheet" href="/docs/assets/style.css" />
  <link type="text/css" rel="stylesheet" href="/docs/assets/pilcrow.css" />
  <link type="text/css" rel="stylesheet" href="/docs/assets/hljs-github.min.css"/>
  <link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css"/>
  <link rel="shortcut icon" href="/docs/assets/favicons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" sizes="57x57" href="/docs/assets/favicons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/docs/assets/favicons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/docs/assets/favicons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/docs/assets/favicons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/docs/assets/favicons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/docs/assets/favicons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/docs/assets/favicons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/docs/assets/favicons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/docs/assets/favicons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/docs/assets/favicons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/docs/assets/favicons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/docs/assets/favicons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/docs/assets/favicons/favicon-16x16.png">
  <link rel="manifest" href="/docs/assets/favicons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/docs/assets/favicons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
  <header>
    <a class="logo" href="/">
      <img class="podium" src="/docs/assets/podium.png">
      Podium
    </a>
    <div class="links">
      <a href="https://github.com/podium-lib/issues/issues">Issues</a>
      <a href="https://github.com/podium-lib" target="_blank">GitHub</a>
    </div>
  </header>
  <div class="content">
    <nav class="main-navigation">

      <h3>Podium</h3>
      <ul>
        <li><a href="/docs/podium/conceptual_overview.html">📚 Overview</a></li>
      </ul>

      <h3>Podlet Guides</h3>
      <ul>
        <li><a href="/docs/podlets/getting_started.html">🚀 Getting Started</a></li>
        <li><a href="/docs/podlets/fallbacks.html">🔌 Fallbacks</a></li>
        <li><a href="/docs/podlets/context.html">✂️ Context</a></li>
        <li><a href="/docs/podlets/proxying.html">🐠 Proxying</a></li>
        <li><a href="/docs/podlets/local_development.html">🔥 Development</a></li>
      </ul>

      <h3>Layout Guides</h3>
      <ul>
        <li><a href="/docs/layouts/getting_started.html">🚀 Getting Started</a></li>
        <li><a href="/docs/layouts/context.html">✂️ Context</a></li>
        <li><a href="/docs/layouts/unavailable_podlets.html">🔌 Unavailable Podlets</a></li>
        <li><a href="/docs/layouts/dynamic_routes.html">🐠 Dynamic Routes</a></li>
        <li><a href="/docs/layouts/assets.html">📦 Assets</a></li>
        <li><a href="/docs/layouts/local_development.html">🔥 Development</a></li>
      </ul>

      <h3>API Docs</h3>
      <ul>
        <li><a href="https://github.com/podium-lib/podlet/blob/master/README.md">📚 Podlet</a></li>
        <li><a href="https://github.com/podium-lib/layout/blob/master/README.md">📚 Layout</a></li>
        <li><a href="https://github.com/podium-lib/context/blob/master/README.md">📚 Context</a></li>
        <li><a href="https://github.com/podium-lib/proxy/blob/master/README.md">📚 Proxy</a></li>
        <li><a href="https://github.com/podium-lib/client/blob/master/README.md">📚 Client</a></li>
      </ul>
    </nav>
    <main class="markdown-body"><h1 id="🔌-fallbacks"><a class="header-link" href="#🔌-fallbacks"></a>🔌 Fallbacks</h1>
<p>👉 This documentation is for Podium podlets version 3.0. <a href="/docs/podlets/v2/fallbacks.html">Version 2.0 documentation</a> is also available.</p>
<p>What happens if a podlet server is down? Unresponsive? Responding too slowly? By default podium will simply render an empty string in its place. You might, however, want to have some measure of control over what gets shown. Enter fallbacks.</p>
<h2 id="how-do-fallbacks-work?"><a class="header-link" href="#how-do-fallbacks-work?"></a>How do fallbacks work?</h2>
<p>On the first request to a podlet, podium will request the podlet’s manifest file inside of which it will discover the location of the podlets fallback route if one has been defined. It will then make a request to the fallback route and cache the response. Later, if the podlet server cannot be reached for any reason, or the request returns a non 200 response, podium will simply display the podlet’s cached fallback content instead.</p>
<p>Note that the podlet’s assets will still be served, so the fallback can depend on both JS and CSS being present once it’s rendered.</p>
<h2 id="defining-a-fallback-route"><a class="header-link" href="#defining-a-fallback-route"></a>Defining a fallback route</h2>
<p>With a podlet instance you call the <code>fallback</code>-function which will return the route from the manifest. By default this is at <code>/fallback</code>. You then attach your handler which receives a simplified version of the context and return the fallback you want.</p>
<pre class="hljs"><code><span class="hljs-keyword">const</span> podlet = <span class="hljs-keyword">new</span> Podlet(<span class="hljs-comment">/*...*/</span>);

<span class="hljs-keyword">const</span> app = express();

app.get(podlet.fallback(), (req, res) =&gt; {
    res.status(<span class="hljs-number">200</span>).podiumSend(<span class="hljs-string">"&lt;div&gt;It didn't work :(&lt;/div&gt;"</span>);
});</code></pre><p>With a custom url, which will be reflected in the manifest.</p>
<pre class="hljs"><code>app.get(podlet.fallback(<span class="hljs-string">'/my-custom-fallback-route'</span>), (req, res) =&gt; {
    res.status(<span class="hljs-number">200</span>).podiumSend(<span class="hljs-string">"&lt;div&gt;It didn't work :(&lt;/div&gt;"</span>);
});</code></pre><p>You can also use some of the Podium context that&#39;s not request bound. This is useful if you need to serve a different fallback depending on where the podlet is mounted.</p>
<pre class="hljs"><code>app.get(podlet.fallback(), (req, res) =&gt; {
    <span class="hljs-keyword">const</span> { publicPathname } = res.locals.podium.context;
    res.status(<span class="hljs-number">200</span>).podiumSend(
        <span class="hljs-string">`&lt;div data-public-path-name=<span class="hljs-subst">${publicPathname}</span>&gt;It didn't work :(&lt;/div&gt;`</span>
    );
});</code></pre><p>The fallback can also point to an external service.</p>
<pre class="hljs"><code><span class="hljs-keyword">const</span> podlet = <span class="hljs-keyword">new</span> Podlet(<span class="hljs-comment">/*...*/</span>);

podlet.fallback(<span class="hljs-string">'https://www.example.com/my-fallback'</span>);</code></pre><h2 id="next-steps"><a class="header-link" href="#next-steps"></a>Next steps</h2>
<ul class="list">
<li><a href="/docs/podlets/context.html">learn about working with the context</a></li>
<li><a href="/docs/podlets/proxying.html">learn about adding additional routes using the proxy</a></li>
<li><a href="/docs/podlets/local_development.html">read about improving your podlet development workflow</a></li>
</ul>
    </main>
  </div>
  <script>
    (function () {
      var pathname = window.location.pathname.substr(1);
      var activeLink = document.querySelector('a[href$="' + pathname + '"]');

      activeLink.classList.add('selected');
    })();
  </script>
</body>
</html>
