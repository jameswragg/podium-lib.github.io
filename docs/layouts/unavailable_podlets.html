<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Podium - 🔌 Handling podlet unavailability</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link type="text/css" rel="stylesheet" href="/docs/assets/style.css" />
  <link type="text/css" rel="stylesheet" href="/docs/assets/pilcrow.css" />
  <link type="text/css" rel="stylesheet" href="/docs/assets/hljs-github.min.css"/>
  <link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css"/>
  <link rel="shortcut icon" href="/docs/assets/favicons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" sizes="57x57" href="/docs/assets/favicons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/docs/assets/favicons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/docs/assets/favicons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/docs/assets/favicons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/docs/assets/favicons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/docs/assets/favicons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/docs/assets/favicons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/docs/assets/favicons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/docs/assets/favicons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/docs/assets/favicons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/docs/assets/favicons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/docs/assets/favicons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/docs/assets/favicons/favicon-16x16.png">
  <link rel="manifest" href="/docs/assets/favicons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/docs/assets/favicons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
  <header>
    <a class="logo" href="/">
      <img class="podium" src="/docs/assets/podium.png">
      Podium
    </a>
    <div class="links">
      <a href="https://github.com/podium-lib/issues/issues">Issues</a>
      <a href="https://github.com/podium-lib" target="_blank">GitHub</a>
    </div>
  </header>
  <div class="content">
    <nav class="main-navigation">

      <h3>Podium</h3>
      <ul>
        <li><a href="/docs/podium/conceptual_overview.html">📚 Overview</a></li>
      </ul>

      <h3>Podlet Guides</h3>
      <ul>
        <li><a href="/docs/podlets/getting_started.html">🚀 Getting Started</a></li>
        <li><a href="/docs/podlets/fallbacks.html">🔌 Fallbacks</a></li>
        <li><a href="/docs/podlets/context.html">✂️ Context</a></li>
        <li><a href="/docs/podlets/proxying.html">🐠 Proxying</a></li>
        <li><a href="/docs/podlets/local_development.html">🔥 Development</a></li>
      </ul>

      <h3>Layout Guides</h3>
      <ul>
        <li><a href="/docs/layouts/getting_started.html">🚀 Getting Started</a></li>
        <li><a href="/docs/layouts/context.html">✂️ Context</a></li>
        <li><a href="/docs/layouts/unavailable_podlets.html">🔌 Unavailable Podlets</a></li>
        <li><a href="/docs/layouts/dynamic_routes.html">🐠 Dynamic Routes</a></li>
        <li><a href="/docs/layouts/assets.html">📦 Assets</a></li>
        <li><a href="/docs/layouts/local_development.html">🔥 Development</a></li>
      </ul>

      <h3>API Docs</h3>
      <ul>
        <li><a href="https://github.com/podium-lib/podlet/blob/master/README.md">📚 Podlet</a></li>
        <li><a href="https://github.com/podium-lib/layout/blob/master/README.md">📚 Layout</a></li>
        <li><a href="https://github.com/podium-lib/context/blob/master/README.md">📚 Context</a></li>
        <li><a href="https://github.com/podium-lib/proxy/blob/master/README.md">📚 Proxy</a></li>
        <li><a href="https://github.com/podium-lib/client/blob/master/README.md">📚 Client</a></li>
      </ul>
    </nav>
    <main class="markdown-body"><h1 id="🔌-handling-podlet-unavailability"><a class="header-link" href="#🔌-handling-podlet-unavailability"></a>🔌 Handling podlet unavailability</h1>
<p>Podium is designed to anticipate and handle the possibility that 1 or more of your podlets may respond slowly or become unavailable from time to time. It does so via the concept of fallbacks.
When a podlet is first fetched, the layout client will cache a copy of the podlet&#39;s fallback content (if defined). If, at a later stage, the layout client cannot fetch the podlet&#39;s content, it will instead use the podlet&#39;s cached fallback content or just an empty string if no fallback content is available. This means that a layout can go on serving requests with the content it can fetch rather than itself become unavailable.</p>
<p>By default, a layout will substitute a fallback (or empty string) for a podlet&#39;s content whenever either the podlet fails to respond with a 2xx status code or the podlet fails to respond within 1000 ms. This default timeout value can be configured by passing options to the layout constructor.</p>
<pre class="hljs"><code><span class="hljs-keyword">const</span> layout = <span class="hljs-keyword">new</span> Layout({
    ...
    client: {
        <span class="hljs-attr">timeout</span>: <span class="hljs-number">2000</span>,
    }
});</code></pre><p>See the <a href="https://github.com/podium-lib/client/blob/master/README.md">@podium/client</a> module for additional documentation.</p>
<h2 id="defining-a-podlet-as-throwable"><a class="header-link" href="#defining-a-podlet-as-throwable"></a>Defining a podlet as throwable</h2>
<p>In some cases it may make no sense to show a page if some of its content is not available. In such cases, you may prefer for the layout to show an error page rather than fallback content or an empty string. This is especially true for dynamic content that is the main focus of a page. If all you can show is a header and footer, it might be better to show an error page explaining the situation to the user.</p>
<p>In order to facilitate this, it is possible to set a podlet as <code>throwable</code> when it is registered.</p>
<p><em>Example</em></p>
<pre class="hljs"><code><span class="hljs-keyword">const</span> gettingStarted = layout.client.register({
    ...
    throwable: <span class="hljs-literal">true</span>,
})</code></pre><p>Then, when fetching content, if that podlet is not available, then the fetch call will reject with an error which you can then handle as you please.</p>
<p><em>Example</em></p>
<pre class="hljs"><code>app.get(<span class="hljs-string">'/'</span>, (req, res, next) =&gt; {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> content = <span class="hljs-keyword">await</span> gettingStarted.fetch(ctx);
        ...
    } <span class="hljs-keyword">catch</span>(err) {
        <span class="hljs-comment">// you might handle this directly...</span>
        <span class="hljs-comment">// res.status(500).send('The getting started guide is currently unavailable');</span>

        <span class="hljs-comment">// or perhaps just pass the error on to be handled in error handling middleware</span>
        <span class="hljs-comment">// next(err);</span>
    }
});</code></pre><h2 id="next-steps"><a class="header-link" href="#next-steps"></a>Next steps</h2>
<ul class="list">
<li><a href="/docs/layouts/context.html">learn about forwarding the Podium context to podlets</a></li>
<li><a href="/docs/layouts/dynamic_routes.html">learn about sharing state between podlets via the URL</a></li>
<li><a href="/docs/layouts/assets.html">learn about options for including client side assets</a></li>
<li><a href="/docs/layouts/local_development.html">read about setting up a layout development workflow</a></li>
</ul>
    </main>
  </div>
  <script>
    (function () {
      var pathname = window.location.pathname.substr(1);
      var activeLink = document.querySelector('a[href$="' + pathname + '"]');

      activeLink.classList.add('selected');
    })();
  </script>
</body>
</html>
