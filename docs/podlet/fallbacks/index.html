<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Fallbacks · Podium</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="What happens if a podlet server is down? Unresponsive? Responding too slowly? By default Podium will simply render an empty string in its place. You might, however, want to have some measure of control over what gets shown. Enter fallbacks."/><meta name="docsearch:version" content="4.2.1"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Fallbacks · Podium"/><meta property="og:type" content="website"/><meta property="og:url" content="https://podium-lib.io//"/><meta property="og:description" content="What happens if a podlet server is down? Unresponsive? Responding too slowly? By default Podium will simply render an empty string in its place. You might, however, want to have some measure of control over what gets shown. Enter fallbacks."/><meta property="og:image" content="https://podium-lib.io/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://podium-lib.io/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/img/favicon-32x32.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css"/><link rel="alternate" type="application/atom+xml" href="https://podium-lib.io/blog/atom.xml" title="Podium Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://podium-lib.io/blog/feed.xml" title="Podium Blog RSS Feed"/><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/favicon-96x96.png" alt="Podium"/><h2 class="headerTitleWithLogo">Podium</h2></a><a href="/versions"><h3>4.2.1</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/podium/conceptual_overview" target="_self">Overview</a></li><li class="siteNavGroupActive"><a href="/docs/podlet/getting_started" target="_self">Podlets</a></li><li class="siteNavGroupActive"><a href="/docs/layout/getting_started" target="_self">Layouts</a></li><li class="siteNavGroupActive"><a href="/docs/api/getting_started" target="_self">API</a></li><li class=""><a href="/help" target="_self">Help</a></li><li class=""><a href="/blog/" target="_self">Blog</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Podlet Guides</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Overview</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/podium/conceptual_overview">Conceptual Overview</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Podlet Guides</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/podlet/getting_started">Getting Started</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/podlet/fallbacks">Fallbacks</a></li><li class="navListItem"><a class="navItem" href="/docs/podlet/context">Context</a></li><li class="navListItem"><a class="navItem" href="/docs/podlet/proxying">Proxying</a></li><li class="navListItem"><a class="navItem" href="/docs/podlet/local_development">Local Development</a></li><li class="navListItem"><a class="navItem" href="/docs/podlet/podlet_to_podlet_communication">Podlet To Podlet Communication In The Browser</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Layout Guides</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/layout/getting_started">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/docs/layout/context">The Podium Context</a></li><li class="navListItem"><a class="navItem" href="/docs/layout/unavailable_podlets">Handling podlet unavailability</a></li><li class="navListItem"><a class="navItem" href="/docs/layout/dynamic_routes">Passing URL params and query string values to podlets</a></li><li class="navListItem"><a class="navItem" href="/docs/layout/assets">Assets</a></li><li class="navListItem"><a class="navItem" href="/docs/layout/local_development">Local Development</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">API Docs</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/api/getting_started">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/docs/api/incoming">HttpIncoming</a></li><li class="navListItem"><a class="navItem" href="/docs/api/assets">Assets</a></li><li class="navListItem"><a class="navItem" href="/docs/api/document">Document Template</a></li><li class="navListItem"><a class="navItem" href="/docs/api/podlet">@podium/podlet</a></li><li class="navListItem"><a class="navItem" href="/docs/api/layout">@podium/layout</a></li><li class="navListItem"><a class="navItem" href="/docs/api/browser">@podium/browser</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Fallbacks</h1></header><article><div><span><p>What happens if a podlet server is down? Unresponsive? Responding too slowly? By default Podium will simply render an empty string in its place. You might, however, want to have some measure of control over what gets shown. Enter fallbacks.</p>
<h2><a class="anchor" aria-hidden="true" id="how-do-fallbacks-work"></a><a href="#how-do-fallbacks-work" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How do fallbacks work?</h2>
<p>On the first request to a podlet, Podium will request the podlet’s manifest file inside of which it will discover the location of the podlets fallback route if one has been defined. It will then make a request to the fallback route and cache the response. Later, if the podlet server cannot be reached for any reason, or the request returns a non 200 response, Podium will simply display the podlet’s cached fallback content instead.</p>
<p>Note that the podlet’s assets will still be served, so the fallback can depend on both JS and CSS being present once it’s rendered.</p>
<h2><a class="anchor" aria-hidden="true" id="defining-a-fallback-route"></a><a href="#defining-a-fallback-route" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Defining a fallback route</h2>
<p>With a podlet instance you call the <code>fallback</code> function which will return the route from the manifest. By default this is at <code>/fallback</code>. You then attach your handler which receives a simplified version of the context and returns the fallback you want.</p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">const</span> podlet = <span class="hljs-keyword">new</span> Podlet(<span class="hljs-comment">/*...*/</span>);

<span class="hljs-keyword">const</span> app = express();

app.get(podlet.fallback(), (req, res) =&gt; {
    res.status(<span class="hljs-number">200</span>).podiumSend(<span class="hljs-string">"&lt;div&gt;It didn't work :(&lt;/div&gt;"</span>);
});
</code></pre>
<p>With a custom URL, which will be reflected in the manifest.</p>
<pre><code class="hljs css language-js">app.get(podlet.fallback(<span class="hljs-string">'/my-custom-fallback-route'</span>), (req, res) =&gt; {
    res.status(<span class="hljs-number">200</span>).podiumSend(<span class="hljs-string">"&lt;div&gt;It didn't work :(&lt;/div&gt;"</span>);
});
</code></pre>
<p>You can also use some of the Podium context that's not request bound. This is useful if you need to serve a different fallback depending on where the podlet is mounted.</p>
<pre><code class="hljs css language-js">app.get(podlet.fallback(), (req, res) =&gt; {
    <span class="hljs-keyword">const</span> { publicPathname } = res.locals.podium.context;
    res.status(<span class="hljs-number">200</span>).podiumSend(
        <span class="hljs-string">`&lt;div data-public-path-name=<span class="hljs-subst">${publicPathname}</span>&gt;It didn't work :(&lt;/div&gt;`</span>
    );
});
</code></pre>
<p>The fallback can also point to an external service.</p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">const</span> podlet = <span class="hljs-keyword">new</span> Podlet(<span class="hljs-comment">/*...*/</span>);

podlet.fallback(<span class="hljs-string">'https://www.example.com/my-fallback'</span>);
</code></pre>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 6/13/2019</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/podlet/getting_started"><span class="arrow-prev">← </span><span>Getting Started</span></a><a class="docs-next button" href="/docs/podlet/context"><span>Context</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#how-do-fallbacks-work">How do fallbacks work?</a></li><li><a href="#defining-a-fallback-route">Defining a fallback route</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/favicon-96x96.png" alt="Podium" width="66" height="58"/></a><div><h5>Documentation</h5><a href="/docs/podium/conceptual_overview">Conceptual overview</a><a href="/docs/podlet/getting_started">Podlets</a><a href="/docs/layout/getting_started">Layouts</a></div><div><h5>API</h5><a href="/docs/api/getting_started">Getting started</a><a href="/docs/api/podlet">Podlets</a><a href="/docs/api/layout">Layouts</a></div><div><h5>Links</h5><a href="/blog">Blog</a><a href="https://github.com/podium-lib/issues">Issues</a><a href="https://github.com/podium-lib">GitHub</a><a href="https://www.npmjs.com/org/podium">npm</a><a href="https://micro-frontends.org/">Micro Frontends</a></div></section><a href="https://finn.no/" target="_blank" rel="noreferrer noopener" class="copyrightLogo"><img src="/img/finn_no_logo.png" alt="FINN.no" width="129" height="45"/></a><section class="copyright">Copyright © 2019 FINN.no Copyright</section></footer></div></body></html>